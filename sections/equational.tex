\section{Algebraic semantics}

\begin{frame}
    \frametitle{Still takes a while}

    \centering
    \LARGE

    This is a \alert{superexponential} upper bound for testing circuit
    equivalence

    \vspace{1em}
    \await
    Can we do better?

\end{frame}

\begin{frame}
    \frametitle{Efficiency is everything}

    \await

    \centering
    \scalebox{4}{\textbf{Algebraic}}

    \scalebox{4}{\textbf{semantics}}

\end{frame}
\begin{frame}
    \frametitle{Mealy is so back}
    \centering

    \Large
    First things first...

    \normalsize
    \await
    \begin{gather*}
        \dsptikzfig{strings/structure/monoid/unitality-l-lhs}
        =
        \dsptikzfig{strings/structure/monoid/unitality-l-rhs}
        \quad
        \dsptikzfig{strings/structure/monoid/unitality-r-lhs}
        =
        \dsptikzfig{strings/structure/monoid/unitality-r-rhs}
        \\[1em]
        \dsptikzfig{circuits/axioms/bottom-delay-lhs}
        =
        \dsptikzfig{circuits/axioms/bottom-delay-rhs}
        \quad
        \dsptikzfig{circuits/instant-feedback/equation-lhs}
        =
        \dsptikzfig{circuits/instant-feedback/fixpoint-concrete}
    \end{gather*}

    \Large
    By these equations, \(
        \dsptikzfig{strings/category/f}[box=F,colour=seq]
        =
        \dsptikzfig{circuits/productivity/mealy-form}
    \)

\end{frame}
\begin{frame}
    \frametitle{It's completely normal}

    \centering
    \LARGE

    We want a way to use equations to translate a circuit into another
    circuit with the same behaviour

\end{frame}
\begin{frame}
    \frametitle{It's completely normal}

    \centering
    \LARGE

    Say we have a procedure \(|-|\) for
    establishing a \alert{canonical circuit} for a function
    \(\morph{f}{\valuetuple{m}}{\valuetuple{n}}\)

    \await

    \vspace{1em}

    A circuit is \alert{normalised} if it is in the image of \(|-|\)

    \await

    \vspace{1em}

    What equations are needed to \\ normalise any circuit?

\end{frame}

\begin{frame}
    \frametitle{It's completely normal}
    \vspace{-1em}

    \begin{gather*}
        \dsptikzfig{circuits/axioms/belnap/and-associativity-lhs}
        =
        \dsptikzfig{circuits/axioms/belnap/and-associativity-rhs}
        \quad
        \dsptikzfig{circuits/axioms/belnap/or-associativity-lhs}
        =
        \dsptikzfig{circuits/axioms/belnap/or-associativity-rhs}
        \\
        \dsptikzfig{circuits/axioms/belnap/and-or-distributivity-lhs}
        =
        \dsptikzfig{circuits/axioms/belnap/and-or-distributivity-rhs}
        \quad
        \dsptikzfig{circuits/axioms/belnap/or-and-distributivity-lhs}
        =
        \dsptikzfig{circuits/axioms/belnap/or-and-distributivity-rhs}
        \\
        \dsptikzfig{circuits/axioms/belnap/and-commutativity-lhs}
        =
        \dsptikzfig{circuits/axioms/belnap/and-commutativity-rhs}
        \quad
        \dsptikzfig{circuits/axioms/belnap/or-commutativity-lhs}
        =
        \dsptikzfig{circuits/axioms/belnap/or-commutativity-rhs}
        \quad
        \dsptikzfig{circuits/axioms/belnap/and-idempotent-lhs}
        =
        \dsptikzfig{circuits/axioms/belnap/and-idempotent-rhs}
        \\
        \dsptikzfig{circuits/axioms/belnap/absorption-2-lhs}
        =
        \dsptikzfig{circuits/axioms/belnap/absorption-2-rhs}
        \quad
        \dsptikzfig{circuits/axioms/belnap/absorption-1-lhs}
        =
        \dsptikzfig{circuits/axioms/belnap/absorption-1-rhs}
        \quad
        \dsptikzfig{circuits/axioms/belnap/or-idempotent-lhs}
        =
        \dsptikzfig{circuits/axioms/belnap/or-idempotent-rhs}
        \\
        \dsptikzfig{circuits/axioms/belnap/translation/and-fork-lhs}
        =
        \dsptikzfig{circuits/axioms/belnap/translation/and-fork-rhs}
        \quad
        \dsptikzfig{circuits/axioms/belnap/translation/or-fork-lhs}
        =
        \dsptikzfig{circuits/axioms/belnap/translation/or-fork-rhs}
        \\
        \dsptikzfig{strings/structure/comonoid/commutativity-rhs}
        =
        \dsptikzfig{strings/structure/comonoid/commutativity-lhs}
        \quad
        \dsptikzfig{strings/structure/comonoid/associativity-lhs}
        =
        \dsptikzfig{strings/structure/comonoid/associativity-rhs}
        \quad
        \dsptikzfig{strings/structure/comonoid/unitality-l-lhs}
        =
        \dsptikzfig{strings/structure/comonoid/unitality-l-rhs}
    \end{gather*}
\end{frame}
\begin{frame}
    \frametitle{It's completely normal}

    \centering
    \LARGE
    Is this enough?
    \await
    \normalsize

    \vspace{1em}

    \dsptikzfig{circuits/examples/state-change/circuit-simpler-mealy}
    \quad
    \dsptikzfig{circuits/examples/state-change/circuit-mealy}

    \vspace{1em}
    \Large
    The cores may \alert{not} have the same semantics!

    \await

    \vspace{0.5em}

    \textbf{Idea:} \alert{encode} circuits so their state words have \\ length
    equal to the number of states

\end{frame}
\begin{frame}
    \frametitle{State your intention}

    \centering
    \LARGE

    Need to know the number of states: \alert{isolate} the state transition
    and output

    \normalsize
    \vspace{1em}
    \(
        \dsptikzfig{circuits/productivity/mealy-form}[core=F,colour=seq]
        =
        \dsptikzfig{circuits/algebraic/encoding}[transition={F_0},output={F_1}]
    \)
\end{frame}
\begin{frame}
    \frametitle{Cartesian doubt}

    \centering
    \Large

    Need equations to make the fork \alert{natural} and \alert{unital}

    \normalsize

    \vspace{1em}

    \(
        \dsptikzfig{strings/structure/cartesian/naturality-copy-lhs}[box=F,colour=seq]
        =
        \dsptikzfig{strings/structure/cartesian/naturality-copy-rhs}[box=F,colour=seq]
        \quad
        \quad
        \dsptikzfig{strings/structure/comonoid/unitality-l-lhs}
        =
        \dsptikzfig{strings/structure/comonoid/unitality-l-rhs}
        \quad
        \dsptikzfig{strings/structure/comonoid/unitality-r-lhs}
        =
        \dsptikzfig{strings/structure/comonoid/unitality-r-rhs}
    \)

    \await
    \normalsize

    \vspace{1em}

    \(
        \dsptikzfig{strings/category/f-1-2}[box=F,colour=seq]
        =
        \dsptikzfig{circuits/algebraic/isolate-cartesian/isolate-step-1}[box=F,colour=seq]
        =
        \dsptikzfig{circuits/algebraic/isolate-cartesian/isolate}[box=F,colour=seq]
    \)


\end{frame}
\begin{frame}
    \frametitle{Cartesian doubt}

    \begin{gather*}
        \dsptikzfig{circuits/axioms/fork-gate-lhs}[gate=p,dom=m,cod=n]
        =
        \dsptikzfig{circuits/axioms/fork-gate-rhs}[gate=p,dom=m,cod=n]
        \quad
        \dsptikzfig{circuits/axioms/fork-lhs}
        =
        \dsptikzfig{circuits/axioms/fork-rhs}
        \quad
        \dsptikzfig{circuits/axioms/delay-fork-lhs}
        =
        \dsptikzfig{circuits/axioms/delay-fork-rhs}
        \\
        \dsptikzfig{strings/structure/frobenius/copy-merge-lhs}
        =
        \dsptikzfig{strings/structure/frobenius/copy-merge-rhs}
        \quad
        \dsptikzfig{strings/structure/bialgebra/merge-copy-lhs}
        =
        \dsptikzfig{strings/structure/bialgebra/merge-copy-rhs}
    \end{gather*}

\end{frame}
\begin{frame}
    \frametitle{Encoding}

    \centering
    \LARGE
    Now add an \alert{encoding} equation

    \await
    \normalsize
    \vspace{1em}

    \(
        \dsptikzfig{circuits/algebraic/encoding}[state=\listvar{s},transition=F,output=G]
        =
        \dsptikzfig{circuits/algebraic/encoding-longstate}[state=\gamma_{\leq}(\listvar{s}),transition={\transitiontranslation{f}},output={\outputtranslation{g}}]
    \)

    \await

    \vspace{1em}
    \scriptsize
    (I'm hiding some of the internal machinations here)

\end{frame}

\begin{frame}
    \frametitle{It is complete}

    \centering
    \Large
    By the completeness of the denotational semantics, each stream function
    has a corresponding \alert{encoded} circuit...

    \await
    \vspace{1em}

    \begin{theorem}
        \centering
        Two circuits are equal by the equations if and only if they are
        denotationally equal.
    \end{theorem}

    \await

    Sound and complete \alert{algebraic semantics}

\end{frame}